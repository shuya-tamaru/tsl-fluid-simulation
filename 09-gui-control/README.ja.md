# 09-gui-control - インタラクティブ SPH パラメータ制御

> [English version is here](README.md)

lil-gui を使用した SPH 流体シミュレーションのインタラクティブ GUI 制御システムで、リアルタイムパラメータ調整とライブシミュレーションチューニングを可能にします。

## プロジェクト構造

```
src/
├── main.ts
└── app/
    ├── App.ts                    # GUI統合メインアプリケーション
    ├── core/                     # コアマネージャー（前のプロジェクトから）
    ├── simulation/
    │   ├── boundary/
    │   │   ├── BoundaryBox.ts    # 動的サイズ変更対応境界コンテナ
    │   │   └── BoundaryConfig.ts # ユニフォーム付き境界設定
    │   └── sph/
    │       ├── Particle.ts       # 動的パーティクル数対応SPHシステム
    │       ├── SPHConfig.ts      # SPHパラメータ
    │       └── calculate/        # コンピュートシェーダー（前のプロジェクトから）
    ├── utils/
    │   └── ParamsControls.ts     # GUI制御システム
    └── types/
        ├── UniformType.ts        # TSLユニフォーム型
        └── BufferType.ts         # ストレージバッファ型
```

## 主な特徴

### 🎛️ インタラクティブパラメータ制御

- **リアルタイム調整**: シミュレーション中のライブパラメータ変更
- **境界制御**: GUI スライダーによる動的境界ボックスサイズ変更
- **パーティクル数制御**: ライブアップデート付き調整可能パーティクル数
- **スムーズ統合**: 既存 SPH システムとのシームレスな GUI 統合

### 🖥️ ユーザーインターフェース

- **lil-gui 統合**: モダンで軽量な GUI ライブラリ
- **直感的制御**: スライダーベースのパラメータ調整
- **ライブアップデート**: リアルタイムシミュレーションパラメータ変更
- **レスポンシブデザイン**: 異なる画面サイズに適応する GUI

### ⚙️ 設定管理

- **BoundaryConfig**: 境界パラメータの集中管理
- **ユニフォーム統合**: 動的値用の TSL ユニフォームノード
- **状態同期**: GUI とシミュレーション状態の一貫性
- **パラメータ検証**: 範囲チェックと値制約

## 技術実装

### GUI 制御システム

```typescript
// パラメータ制御初期化
this.gui
  .add(this.boundaryConfig.width, "value", 10, 32, 0.2)
  .name("Box Width")
  .onChange(() => {
    this.boundaryBoxManager.updateSizes();
  });
```

### 動的境界設定

```typescript
// TSLユニフォーム付きBoundaryConfig
export class BoundaryConfig {
  public width = uniform(16);
  public height = uniform(16);
  public depth = uniform(16);
}
```

### リアルタイムパラメータアップデート

```typescript
// ライブパーティクル数調整
this.gui
  .add(this.sphConfig, "particleCount", 1000, 20000, 1000)
  .name("Particle Count")
  .onChange(async (count: number) => {
    await this.particleManager.updateParticleCount(count);
  });
```

## GUI 機能

### インタラクティブ制御

- **Box Width**: 境界ボックス幅調整（10-32 範囲）
- **Box Depth**: 境界ボックス深さ調整（10-32 範囲）
- **Particle Count**: 動的パーティクル数（1000-20000 範囲）

### リアルタイム効果

- **境界リサイズ**: 境界変更の即座の視覚フィードバック
- **パーティクルスケーリング**: システム再初期化付きライブパーティクル数調整
- **シミュレーション継続性**: パラメータ変更中のシミュレーション状態維持

## 設定アーキテクチャ

### BoundaryConfig

- **TSL ユニフォーム**: コンピュートシェーダーとの直接統合
- **動的値**: リアルタイムパラメータアップデート
- **型安全性**: パラメータ検証用 TypeScript 統合

### SPHConfig 統合

- **拡張パラメータ**: 追加の GUI 制御可能パラメータ
- **ライブアップデート**: リアルタイムシミュレーションパラメータ変更
- **状態管理**: コンポーネント間の一貫したパラメータ状態

## パフォーマンス特徴

### 効率的アップデート

- **最小再初期化**: 影響を受けるシステムのみアップデート
- **GPU 同期**: コンピュートシェーダーアップデート用の適切な非同期処理
- **メモリ管理**: パーティクル数変更用の効率的なバッファ再割り当て

### ユーザーエクスペリエンス

- **スムーズな相互作用**: シミュレーション中断なしのレスポンシブ GUI
- **視覚フィードバック**: パラメータ調整の即座の視覚変化
- **パラメータ永続性**: 相互作用間での GUI 状態維持

## 統合の利点

### 開発ワークフロー

- **迅速なプロトタイピング**: クイックパラメータテストと調整
- **視覚的デバッグ**: パラメータ効果のリアルタイム可視化
- **ユーザーテスト**: 異なるシナリオ用の簡単なパラメータ探索

### シミュレーションチューニング

- **リアルタイム最適化**: ライブパラメータ微調整
- **視覚分析**: パラメータ変更の即座のフィードバック
- **パフォーマンス監視**: GUI 支援パフォーマンス最適化

## 使用方法

### パラメータ調整

1. **境界制御**: スライダーを使用して境界ボックス寸法を調整
2. **パーティクルスケーリング**: 異なるシミュレーションスケール用にパーティクル数を変更
3. **ライブアップデート**: 変更が実行中のシミュレーションに即座に適用

### GUI 相互作用

- **スライダー制御**: 直感的な範囲ベースパラメータ調整
- **リアルタイムフィードバック**: パラメータ変更の即座の視覚応答
- **継続シミュレーション**: 調整中のシミュレーションフローの中断なし
